CREATE TABLE IF NOT EXISTS recetas (
    CodProd NVARCHAR(255) PRIMARY KEY, -- Cambiado a NVARCHAR(255)
    CodMat NVARCHAR(MAX) DEFAULT NULL,
    DesProd NVARCHAR(MAX) DEFAULT NULL,
    CantMat DECIMAL(10,3) DEFAULT NULL -- Cambiado a DECIMAL(10,3)
);

SELECT DISTINCT
    t1.CodProd,
    CASE 
        WHEN t1.CodMat = 'PLA21001730004C20 ' THEN 'PLA21001730004C20' -- CODIGO CON UN ESPACIO
        WHEN t1.CodMat = 'PL189021450007D94 ' THEN 'PLA189021450007D94' -- CODIGO ESTA MALO EN SL
        WHEN t1.CodMat = 'PLA204021450007D94' THEN 'PLA220021450007D94' -- CAMBIADA EN SOFTLAND
        WHEN t1.CodMat = 'PLA09500765000309B' THEN 'PLA09500780000309B'
        WHEN t1.CodMat = 'PLA11000765000309B' THEN 'PLA11000780000309B'
        WHEN t1.CodMat = 'PLA11000795000309B' THEN 'PLA11000780000309B'
        WHEN t1.CodMat = 'PLA12000765000309B' THEN 'PLA11000780000309B'
        WHEN t1.CodMat = 'PLA09500765000210E' THEN 'PLA09500780000210E'
        WHEN t1.CodMat = 'PLA11000700000210E' THEN 'PLA11000780000210E'
        WHEN t1.CodMat = 'PLA210021600004C20' THEN 'PLA210021450004C20' -- MALA LA PLACA (NO EXISTE)
        WHEN t1.CodMat = 'PLA270015700000C20' THEN 'PLA270015700004C20' -- MALO EL ESPESOR EN EL CODIGO
        WHEN t1.CodMat = 'PLA280021600004C20' THEN 'PLA280021450004C20' -- MALA LA PLACA (NO EXISTE)
        WHEN t1.CodMat = 'PLA220021600007D92' THEN 'PLA220021450007D92' -- MALA LA PLACA (NO EXISTE)
        WHEN t1.CodMat = 'PLA235021450007D94' THEN 'PLA189021450007D94' -- NO EXISTE ESA PLACA Y ESA DIJO QUE USABAN
        WHEN t1.CodMat = 'PLA186021450007D98' THEN 'PLA186011650007D98' -- MALA LA PLACA (NO EXISTE)
        WHEN t1.CodMat = 'PLA233021450007D98' THEN 'PLA233011650007D98' -- MALA LA PLACA (NO EXISTE)
        WHEN t1.CodMat = 'PLA24001720004C20' THEN 'PLA250017300004C20' -- CAMBIADA EN SOFTLAND
        ELSE t1.CodMat -- Si no coincide, se mantiene el valor original
    END AS CodMat,
    t2.DesProd,
    t1.CantMat
FROM 
    softland.dwrecmat t1
INNER JOIN 
    softland.iw_tprod t2
ON 
    t1.CodMat = t2.CodProd
WHERE 
    t2.DesProd LIKE '%PLACA%'
    AND t2.DesProd NOT LIKE '%ADHESIVO%';